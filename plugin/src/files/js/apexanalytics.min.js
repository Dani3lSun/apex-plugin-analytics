apex.da.apexAnalytics={pluginHandler:function(e){var a={callAnalyticsWebservice:function(e,a,r){try{$.ajax({url:e,type:"POST",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){e.success?(apex.event.trigger("body","apexanalytics-ajax-success",e),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Success",e),r({success:!0})):(apex.event.trigger("body","apexanalytics-ajax-error",{message:e.message}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",e.message),r({success:!1}))},error:function(e,a,n){apex.event.trigger("body","apexanalytics-ajax-error",{message:n}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",n),r({success:!1})}})}catch(e){apex.event.trigger("body","apexanalytics-ajax-error",{message:e}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",e),r({success:!1})}},setAnalyticsErrorSessionStorage:function(e){if(apex.storage.hasSessionStorageSupport()){var a=$v("pInstance");apex.storage.getScopedSessionStorage({prefix:"apexAnalytics",useAppId:!0}).setItem(a+".errorCount",e)}},getAnalyticsErrorSessionStorage:function(){var e;if(apex.storage.hasSessionStorageSupport()){var a=$v("pInstance");e=apex.storage.getScopedSessionStorage({prefix:"apexAnalytics",useAppId:!0}).getItem(a+".errorCount")}return e||"0"},setErrorCountUp:function(){var e=parseInt(a.getAnalyticsErrorSessionStorage())+1;a.setAnalyticsErrorSessionStorage(e)},checkErrorCount:function(e){return parseInt(a.getAnalyticsErrorSessionStorage())+1<=e},hasTouchSupport:function(){return"ontouchstart"in window||navigator.msMaxTouchPoints>0?"Y":"N"},getScreenWidth:function(){return window.screen.width||0},getScreenHeight:function(){return window.screen.height||0},getBrowserLanguage:function(){return navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage},getPageLoadTime:function(e){var a;if("ready"==e){a=((new Date).getTime()-performance.timing.navigationStart)/1e3}else a=0;return a||0},isDoNotTrackActive:function(){return!!(window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack||"msTrackingProtectionEnabled"in window.external)&&!("1"!=window.doNotTrack&&"yes"!=navigator.doNotTrack&&"1"!=navigator.doNotTrack&&"1"!=navigator.msDoNotTrack&&!window.external.msTrackingProtectionEnabled())},isDoNotTrackCompleteActive:function(e){return"Y"==e&&!!a.isDoNotTrackActive()},buildAnalyticsJson:function(e,r,n,t){var o=(new UAParser).getResult(),s={},i="";return o.browser.name&&o.browser.version&&o.os.name&&o.os.version&&("N"==t?s={encodeWebserviceCall:t,analyticsId:e,agentName:o.browser.name,agentVersion:o.browser.version,agentLanguage:a.getBrowserLanguage(),osName:o.os.name,osVersion:o.os.version,hasTouchSupport:a.hasTouchSupport(),pageLoadTime:a.getPageLoadTime(r),screenWidth:a.getScreenWidth(),screenHeight:a.getScreenHeight(),apexAppId:$v("pFlowId"),apexPageId:$v("pFlowStepId"),eventName:r,additionalInfo:$v(n)}:(i=e+":::",i+=o.browser.name+":::",i+=o.browser.version+":::",i+=a.getBrowserLanguage()+":::",i+=o.os.name+":::",i+=o.os.version+":::",i+=a.hasTouchSupport()+":::",i+=a.getPageLoadTime(r)+":::",i+=a.getScreenWidth()+":::",i+=a.getScreenHeight()+":::",i+=$v("pFlowId")+":::",i+=$v("pFlowStepId")+":::",i+=r+":::",i+=$v(n),s={encodeWebserviceCall:t,encodedString:btoa(i)})),s},pluginHandler:function(e){var r=e.analyticsId,n=e.eventName,t=e.analyticsRestUrl,o=e.additionalInfoItem,s=e.encodeWebserviceCall,i=e.stopOnMaxError,c=e.respectDoNotTrack;if(apex.debug.log("apexAnalytics.pluginHandler - analyticsId",r),apex.debug.log("apexAnalytics.pluginHandler - eventName",n),apex.debug.log("apexAnalytics.pluginHandler - analyticsRestUrl",t),apex.debug.log("apexAnalytics.pluginHandler - additionalInfoItem",o),apex.debug.log("apexAnalytics.pluginHandler - encodeWebserviceCall",s),apex.debug.log("apexAnalytics.pluginHandler - stopOnMaxError",i),apex.debug.log("apexAnalytics.pluginHandler - respectDoNotTrack",c),!a.isDoNotTrackCompleteActive(c)&&a.checkErrorCount(i)){var g=a.buildAnalyticsJson(r,n,o,s);g?a.callAnalyticsWebservice(t,g,function(e){e.success||a.setErrorCountUp()}):a.setErrorCountUp()}}};try{a.pluginHandler(e)}catch(e){apex.debug.log("apexAnalytics.pluginHandler error",e),a.setErrorCountUp()}}};