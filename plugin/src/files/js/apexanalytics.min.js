apex.da.apexAnalytics={pluginHandler:function(e){var a={callAnalyticsWebservice:function(e,a,n){try{$.ajax({url:e,type:"POST",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){e.success?(apex.event.trigger("body","apexanalytics-ajax-success",e),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Success",e),n({success:!0})):(apex.event.trigger("body","apexanalytics-ajax-error",{message:e.message}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",e.message),n({success:!1}))},error:function(e,a,r){apex.event.trigger("body","apexanalytics-ajax-error",{message:r}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",r),n({success:!1})}})}catch(e){apex.event.trigger("body","apexanalytics-ajax-error",{message:e}),apex.debug.log("apexAnalytics.callAnalyticsWebservice AJAX Error",e),n({success:!1})}},setAnalyticsErrorSessionStorage:function(e){if(apex.storage.hasSessionStorageSupport()){var a=$v("pInstance");apex.storage.getScopedSessionStorage({prefix:"apexAnalytics",useAppId:!0}).setItem(a+".errorCount",e)}},getAnalyticsErrorSessionStorage:function(){var e;if(apex.storage.hasSessionStorageSupport()){var a=$v("pInstance");e=apex.storage.getScopedSessionStorage({prefix:"apexAnalytics",useAppId:!0}).getItem(a+".errorCount")}return e||"0"},setErrorCountUp:function(){var e=parseInt(a.getAnalyticsErrorSessionStorage())+1;a.setAnalyticsErrorSessionStorage(e)},checkErrorCount:function(e){return parseInt(a.getAnalyticsErrorSessionStorage())+1<=e},hasTouchSupport:function(){return"ontouchstart"in window||navigator.msMaxTouchPoints>0?"Y":"N"},getScreenWidth:function(){return window.screen.width||0},getScreenHeight:function(){return window.screen.height||0},getBrowserLanguage:function(){return navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage},getPageLoadTime:function(e){var a;if("ready"==e){a=((new Date).getTime()-performance.timing.navigationStart)/1e3}else a=0;return a||0},buildAnalyticsJson:function(e,n,r,t){var s=(new UAParser).getResult(),o={},i="";return s.browser.name&&s.browser.version&&s.os.name&&s.os.version&&("N"==t?o={encodeWebserviceCall:t,analyticsId:e,agentName:s.browser.name,agentVersion:s.browser.version,agentLanguage:a.getBrowserLanguage(),osName:s.os.name,osVersion:s.os.version,hasTouchSupport:a.hasTouchSupport(),pageLoadTime:a.getPageLoadTime(n),screenWidth:a.getScreenWidth(),screenHeight:a.getScreenHeight(),apexAppId:$v("pFlowId"),apexPageId:$v("pFlowStepId"),eventName:n,additionalInfo:$v(r)}:(i=e+":::",i+=s.browser.name+":::",i+=s.browser.version+":::",i+=a.getBrowserLanguage()+":::",i+=s.os.name+":::",i+=s.os.version+":::",i+=a.hasTouchSupport()+":::",i+=a.getPageLoadTime(n)+":::",i+=a.getScreenWidth()+":::",i+=a.getScreenHeight()+":::",i+=$v("pFlowId")+":::",i+=$v("pFlowStepId")+":::",i+=n+":::",i+=$v(r),o={encodeWebserviceCall:t,encodedString:btoa(i)})),o},pluginHandler:function(e){var n=e.analyticsId,r=e.eventName,t=e.analyticsRestUrl,s=e.additionalInfoItem,o=e.encodeWebserviceCall,i=e.stopOnMaxError;if(apex.debug.log("apexAnalytics.pluginHandler - analyticsId",n),apex.debug.log("apexAnalytics.pluginHandler - eventName",r),apex.debug.log("apexAnalytics.pluginHandler - analyticsRestUrl",t),apex.debug.log("apexAnalytics.pluginHandler - additionalInfoItem",s),apex.debug.log("apexAnalytics.pluginHandler - encodeWebserviceCall",o),apex.debug.log("apexAnalytics.pluginHandler - stopOnMaxError",i),a.checkErrorCount(i)){var c=a.buildAnalyticsJson(n,r,s,o);c?a.callAnalyticsWebservice(t,c,function(e){e.success||a.setErrorCountUp()}):a.setErrorCountUp()}}};a.pluginHandler(e)}};